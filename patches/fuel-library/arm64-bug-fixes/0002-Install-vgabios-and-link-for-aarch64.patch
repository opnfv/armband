From: Alexandru Avadanii <Alexandru.Avadanii@enea.com>
Date: Tue, 15 Mar 2016 11:33:52 +0100
Subject: [PATCH] Install vgabios (and link) for aarch64

vgabios is needed for standard VGA mode in AArch64 VMs, so
install it by default on AArch64 and create missing link
in </usr/share/qemu> to </usr/share/vgabios/vgabios.bin>.

Signed-off-by: Alexandru Avadanii <Alexandru.Avadanii@enea.com>
Signed-off-by: Stanislaw Kardach <stanislaw.kardach@cavium.com>
---
 deployment/puppet/openstack_tasks/manifests/roles/compute.pp | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/deployment/puppet/openstack_tasks/manifests/roles/compute.pp b/deployment/puppet/openstack_tasks/manifests/roles/compute.pp
index 4240126..b18fa7b 100644
--- a/deployment/puppet/openstack_tasks/manifests/roles/compute.pp
+++ b/deployment/puppet/openstack_tasks/manifests/roles/compute.pp
@@ -409,6 +409,14 @@ class openstack_tasks::roles::compute {
     vncserver_listen                           => '0.0.0.0',
     remove_unused_original_minimum_age_seconds => pick($nova_hash_real['remove_unused_original_minimum_age_seconds'], '86400'),
     libvirt_service_name                       => $::nova::params::libvirt_service_name,
+  } ->
+  package { 'vgabios':
+    ensure => present;
+  } ->
+  file { '/usr/share/qemu/vgabios-stdvga.bin':
+    ensure  => link,
+    target  => '/usr/share/vgabios/vgabios.bin',
+    replace => false,
   }

   class { '::nova::migration::libvirt':
